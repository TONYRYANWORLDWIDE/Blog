<!DOCTYPE html>
<html lang="english">
<head>
        <meta charset="utf-8" />
        <title>NBA Standings to PostgreSQL</title>
        <link rel="stylesheet" href="https://Tonyryanworldwide.github.io/Blog/theme/css/main.css" />
        <link href="https://Tonyryanworldwide.github.io/Blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Tony's Blog Atom Feed" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://Tonyryanworldwide.github.io/Blog/">Tony's Blog </a></h1>
                <nav><ul>
                    <li class="active"><a href="https://Tonyryanworldwide.github.io/Blog/category/posts.html">Posts</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="https://Tonyryanworldwide.github.io/Blog/NBA.html" rel="bookmark"
           title="Permalink to NBA Standings to PostgreSQL">NBA Standings to PostgreSQL</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-12-29T00:00:00-05:00">
                Published: Sat 29 December 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://Tonyryanworldwide.github.io/Blog/author/tony-ryan.html">Tony Ryan</a>
        </address>
<p>In <a href="https://Tonyryanworldwide.github.io/Blog/category/posts.html">Posts</a>.</p>
<p>tags: <a href="https://Tonyryanworldwide.github.io/Blog/tag/pelican.html">pelican</a> <a href="https://Tonyryanworldwide.github.io/Blog/tag/nba.html">NBA</a> <a href="https://Tonyryanworldwide.github.io/Blog/tag/selenium.html">Selenium</a> </p>
</footer><!-- /.post-info -->      <h1>Get All Games</h1>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support.ui</span> <span class="kn">import</span> <span class="n">WebDriverWait</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support</span> <span class="kn">import</span> <span class="n">expected_conditions</span> <span class="k">as</span> <span class="n">EC</span> 
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">requests</span> <span class="kn">import</span> <span class="n">get</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">docx</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">Inches</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="n">NBA_Season_months</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;October&#39;</span><span class="p">:[</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">2018</span><span class="p">]</span> <span class="p">,</span> <span class="s1">&#39;November&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2018</span><span class="p">]</span> <span class="p">,</span> <span class="s1">&#39;December&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2018</span><span class="p">],</span> <span class="s1">&#39;January&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2019</span><span class="p">]</span>
                     <span class="p">,</span><span class="s1">&#39;February&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">2019</span><span class="p">],</span> <span class="s1">&#39;March&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">2019</span><span class="p">],</span> <span class="s1">&#39;April&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">2019</span><span class="p">],</span> <span class="s1">&#39;May&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">2019</span><span class="p">]}</span>



<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;C:/users/Tonyryanworldwide/untitled folder/chromedriver_win32&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

<span class="c1"># options = webdriver.ChromeOptions()</span>
<span class="c1"># options.add_argument(&#39;--ignore-certificate-errors&#39;)</span>
<span class="c1"># options.add_argument(&quot;--test-type&quot;)</span>
<span class="c1"># driver = webdriver.Chrome(options=options)</span>


<span class="n">home</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">away</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">home_score</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">away_score</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">games</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">date</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">#urls = []</span>

<span class="c1"># for month in range(1,8):</span>
<span class="c1">#     urls.append(&#39;https://stats.nba.com/schedule/#!?Month=&#39; + str(month) + &#39;&amp;PD=N&#39;)</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">NBA_Season_months</span><span class="p">:</span>
    <span class="n">month</span> <span class="o">=</span> <span class="n">NBA_Season_months</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">year</span> <span class="o">=</span> <span class="n">NBA_Season_months</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://stats.nba.com/schedule/#!?Month=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">month</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&amp;PD=N&#39;</span>
    <span class="k">if</span> <span class="n">year</span> <span class="o">==</span> <span class="mi">2018</span><span class="p">:</span>


    <span class="c1">#for i in range(0,7):</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ChromeOptions</span><span class="p">()</span>
        <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--ignore-certificate-errors&#39;</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--test-type&quot;</span><span class="p">)</span>
        <span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>

        <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">scores_start</span>  <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_elements_by_xpath</span><span class="p">(</span><span class="s1">&#39;/html/body/main/div[2]/div/div[2]/div/div&#39;</span><span class="p">)</span>

        <span class="n">s2</span> <span class="o">=</span> <span class="n">scores_start</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;outerHTML&#39;</span><span class="p">)</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
        <span class="n">dates</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="n">class_</span> <span class="o">=</span> <span class="s2">&quot;row collapse schedule-content&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">)):</span>
            <span class="c1">#print(dates[x].a.text)</span>
            <span class="n">tables</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">)</span>


            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tables</span><span class="p">)):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">away</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                    <span class="n">away_score</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;td&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                    <span class="n">home</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                    <span class="n">home_score</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;td&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

                    <span class="n">date</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dates</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

                    <span class="n">ab</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">text</span>
                    <span class="n">date_dt1</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">ab</span><span class="p">,</span> <span class="s1">&#39;%A, %B </span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">date</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">date_dt1</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%m/</span><span class="si">%d</span><span class="s2">/%Y&quot;</span><span class="p">))</span>
                <span class="k">except</span><span class="p">:</span>        
                    <span class="n">home</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">away</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">home_score</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">aways_score</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">date</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">games</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">home</span> <span class="o">+</span> <span class="n">home_score</span> <span class="o">+</span> <span class="n">away</span> <span class="o">+</span> <span class="n">away_score</span> <span class="o">+</span> <span class="n">date</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">games</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
                    <span class="n">games</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="n">home</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">away</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">home_score</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">away_score</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">date</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>


<h1>Get Current Month Games</h1>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support.ui</span> <span class="kn">import</span> <span class="n">WebDriverWait</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support</span> <span class="kn">import</span> <span class="n">expected_conditions</span> <span class="k">as</span> <span class="n">EC</span> 
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">requests</span> <span class="kn">import</span> <span class="n">get</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">docx</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">Inches</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="n">NBA_Season_months</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;October&#39;</span><span class="p">:[</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">2018</span><span class="p">]</span> <span class="p">,</span> <span class="s1">&#39;November&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2018</span><span class="p">]</span> <span class="p">,</span> <span class="s1">&#39;December&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2018</span><span class="p">],</span> <span class="s1">&#39;January&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2019</span><span class="p">]</span>
                     <span class="p">,</span><span class="s1">&#39;February&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">2019</span><span class="p">],</span> <span class="s1">&#39;March&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">2019</span><span class="p">],</span> <span class="s1">&#39;April&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">2019</span><span class="p">],</span> <span class="s1">&#39;May&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">2019</span><span class="p">]}</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">start</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%B&#39;</span><span class="p">)</span>
<span class="n">month</span> <span class="o">=</span> <span class="n">NBA_Season_months</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">year</span> <span class="o">=</span> <span class="n">NBA_Season_months</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;C:/users/Tonyryanworldwide/untitled folder/chromedriver_win32&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

<span class="n">options</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ChromeOptions</span><span class="p">()</span>
<span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--ignore-certificate-errors&#39;</span><span class="p">)</span>
<span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--test-type&quot;</span><span class="p">)</span>
<span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>


<span class="n">home</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">away</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">home_score</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">away_score</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">games</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">date</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">urls</span> <span class="o">=</span> <span class="p">[]</span>


<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://stats.nba.com/schedule/#!?Month=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">month</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&amp;PD=N&#39;</span>


<span class="n">options</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ChromeOptions</span><span class="p">()</span>
<span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--ignore-certificate-errors&#39;</span><span class="p">)</span>
<span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--test-type&quot;</span><span class="p">)</span>
<span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>

<span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">scores_start</span>  <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_elements_by_xpath</span><span class="p">(</span><span class="s1">&#39;/html/body/main/div[2]/div/div[2]/div/div&#39;</span><span class="p">)</span>

<span class="n">s2</span> <span class="o">=</span> <span class="n">scores_start</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;outerHTML&#39;</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="n">class_</span> <span class="o">=</span> <span class="s2">&quot;row collapse schedule-content&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">)):</span>
    <span class="c1">#print(dates[x].a.text)</span>
    <span class="n">tables</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">)</span>


    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tables</span><span class="p">)):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">away</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="n">away_score</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;td&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="n">home</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
            <span class="n">home_score</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;td&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

            <span class="n">date</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dates</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

            <span class="n">ab</span> <span class="o">=</span> <span class="n">dates</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">text</span>
            <span class="n">date_dt1</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">ab</span><span class="p">,</span> <span class="s1">&#39;%A, %B </span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">date</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">date_dt1</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%m/</span><span class="si">%d</span><span class="s2">/%Y&quot;</span><span class="p">))</span>

        <span class="k">except</span><span class="p">:</span>        
            <span class="n">home</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">away</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">home_score</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">aways_score</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">date</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">games</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">home</span> <span class="o">+</span> <span class="n">home_score</span> <span class="o">+</span> <span class="n">away</span> <span class="o">+</span> <span class="n">away_score</span> <span class="o">+</span> <span class="n">date</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">games</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">games</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">home</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">away</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">home_score</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">away_score</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">date</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;home&#39;</span><span class="p">,</span> <span class="s1">&#39;hscore&#39;</span><span class="p">,</span> <span class="s1">&#39;away&#39;</span><span class="p">,</span> <span class="s1">&#39;ascore&#39;</span><span class="p">,</span> <span class="s1">&#39;dayOfWeekDate&#39;</span><span class="p">,</span><span class="s1">&#39;date&#39;</span><span class="p">]</span>
<span class="n">Games_DF</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">games</span><span class="p">,</span><span class="n">columns</span> <span class="o">=</span><span class="n">cols</span><span class="p">)</span>
<span class="n">Games_DF</span><span class="o">.</span><span class="n">hscore</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">Games_DF</span><span class="p">[</span><span class="s1">&#39;hscore&#39;</span><span class="p">])</span>
<span class="n">Games_DF</span><span class="o">.</span><span class="n">ascore</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">Games_DF</span><span class="p">[</span><span class="s1">&#39;ascore&#39;</span><span class="p">])</span>
<span class="n">Games_Played</span> <span class="o">=</span> <span class="n">Games_DF</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Games_DF</span><span class="o">.</span><span class="n">hscore</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>
<span class="n">Games_Played</span> <span class="o">=</span> <span class="n">Games_Played</span><span class="p">[</span><span class="n">Games_Played</span><span class="o">.</span><span class="n">date</span> <span class="o">&gt;=</span> <span class="s1">&#39;10/16/2018&#39;</span><span class="p">]</span> <span class="c1">## Regular Season Start</span>

<span class="n">Games_Played</span><span class="p">[</span><span class="s1">&#39;home_won&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Games_Played</span><span class="p">[</span><span class="s1">&#39;hscore&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Games_Played</span><span class="p">[</span><span class="s1">&#39;ascore&#39;</span><span class="p">],</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Games_Played</span><span class="p">[</span><span class="s1">&#39;hscore&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">Games_Played</span><span class="p">[</span><span class="s1">&#39;ascore&#39;</span><span class="p">],</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">Games_Played</span><span class="p">[</span><span class="s1">&#39;away_won&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Games_Played</span><span class="p">[</span><span class="s1">&#39;ascore&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Games_Played</span><span class="p">[</span><span class="s1">&#39;hscore&#39;</span><span class="p">],</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Games_Played</span><span class="p">[</span><span class="s1">&#39;hscore&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">Games_Played</span><span class="p">[</span><span class="s1">&#39;ascore&#39;</span><span class="p">],</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">Games_Played</span><span class="p">[</span><span class="s1">&#39;home_differential&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Games_Played</span><span class="o">.</span><span class="n">hscore</span> <span class="o">-</span> <span class="n">Games_Played</span><span class="o">.</span><span class="n">ascore</span>
<span class="n">Games_Played</span><span class="p">[</span><span class="s1">&#39;away_differential&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Games_Played</span><span class="o">.</span><span class="n">ascore</span> <span class="o">-</span> <span class="n">Games_Played</span><span class="o">.</span><span class="n">hscore</span>
<span class="n">HDif</span> <span class="o">=</span> <span class="n">Games_Played</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()[</span><span class="s1">&#39;home_differential&#39;</span><span class="p">]</span>
<span class="n">ADif</span> <span class="o">=</span> <span class="n">Games_Played</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;away&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()[</span><span class="s1">&#39;away_differential&#39;</span><span class="p">]</span>
<span class="n">HWon</span> <span class="o">=</span> <span class="n">Games_Played</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()[</span><span class="s1">&#39;home_won&#39;</span><span class="p">]</span>
<span class="n">Awon</span> <span class="o">=</span> <span class="n">Games_Played</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;away&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()[</span><span class="s1">&#39;away_won&#39;</span><span class="p">]</span>

<span class="n">Games_Played</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">Games_Played</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">Games_Played</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">Differential</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">ADif</span><span class="p">,</span> <span class="n">HDif</span><span class="p">,</span> <span class="n">HWon</span><span class="p">,</span> <span class="n">Awon</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Differential</span><span class="p">[</span><span class="s1">&#39;total_net_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Differential</span><span class="o">.</span><span class="n">away_differential</span> <span class="o">+</span> <span class="n">Differential</span><span class="o">.</span><span class="n">home_differential</span>
<span class="n">Differential</span><span class="p">[</span><span class="s1">&#39;total_wins&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Differential</span><span class="p">[</span><span class="s1">&#39;home_won&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">Differential</span><span class="p">[</span><span class="s1">&#39;away_won&#39;</span><span class="p">]</span>
<span class="n">Differential</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;total_net_points&#39;</span> <span class="p">,</span><span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>  
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">ggplot</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">tnp</span> <span class="o">=</span> <span class="n">Differential</span><span class="p">[</span><span class="s1">&#39;total_net_points&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">tw</span> <span class="o">=</span> <span class="n">Differential</span><span class="p">[</span><span class="s1">&#39;total_wins&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">linear_regressor</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span> 
<span class="n">linear_regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">tnp</span><span class="p">,</span> <span class="n">tw</span><span class="p">)</span> 
<span class="n">Y_pred</span> <span class="o">=</span> <span class="n">linear_regressor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">tnp</span><span class="p">)</span> 

<span class="n">p</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">tnp</span><span class="p">,</span><span class="n">tw</span><span class="p">,</span><span class="n">Y_pred</span><span class="p">)))</span>
<span class="n">p</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Net Points&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Wins&#39;</span> <span class="p">,</span> <span class="s1">&#39;Predicted Wins&#39;</span><span class="p">]</span>
<span class="n">ggplot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">aes</span> <span class="p">(</span> <span class="s1">&#39;Net Points&#39;</span><span class="p">,</span> <span class="s1">&#39;Predicted Wins&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="n">geom_line</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="s1">&#39;Net Points&#39;</span> <span class="p">,</span> <span class="s1">&#39;Total Wins&#39;</span><span class="p">))</span>
</pre></div>


<h1>Create Table Syntax</h1>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">psycopg2</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
<span class="c1">#from config import config</span>


<span class="n">command</span> <span class="o">=</span> <span class="p">(</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Create Table games_played_reg_season</span>
<span class="sd">(</span>
<span class="sd">away_differential float, home_differential float, home_won float, aways_won float,</span>
<span class="sd">   total_net_points float, total_wins float</span>

<span class="sd">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="p">)</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">&#39;postgresql+psycopg2://postgres:COLLECTORGOD@11@localhost:5432/tonyfirst&#39;</span><span class="p">)</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">raw_connection</span><span class="p">()</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="c1"># commit the changes</span>
<span class="c1"># cur.execute(command)</span>
<span class="c1"># cur.close()</span>
<span class="c1"># conn.commit()</span>
</pre></div>


<h1>DataFrame to New Table syntax</h1>
<div class="highlight"><pre><span></span><span class="c1"># from sqlalchemy import create_engine</span>
<span class="c1"># engine = create_engine(&#39;postgresql+psycopg2://postgres:&lt;PASSWORD&gt;@localhost:5432/tonyfirst&#39;)</span>

<span class="c1"># Games_Played.to_sql(&#39;games_played_reg_season&#39; , con = engine)</span>
</pre></div>


<h1>DataFrame to Existing Table syntax</h1>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">&#39;postgresql+psycopg2://postgres:COLLECTORGOD@11@localhost:5432/tonyfirst&#39;</span><span class="p">)</span>

<span class="n">Games_Played</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s1">&#39;games_played_reg_season&#39;</span> <span class="p">,</span> <span class="n">con</span> <span class="o">=</span> <span class="n">engine</span><span class="p">,</span> <span class="n">if_exists</span> <span class="o">=</span> <span class="s1">&#39;append&#39;</span><span class="p">)</span>
</pre></div>


<h1>Select  from POSTGRESQL Table</h1>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">&#39;postgresql+psycopg2://postgres:COLLECTORGOD@11@localhost:5432/tonyfirst&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;Select * from wins&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">psycopg2</span>

<span class="n">command</span> <span class="o">=</span> <span class="p">(</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">DROP TABLE IF EXISTS temp1</span>
<span class="sd">;</span>
<span class="sd">CREATE TEMP TABLE temp1 AS</span>
<span class="sd">Select *, row_number() over(partition by date, home  order by hscore desc, ascore desc) theord from games_played_reg_season</span>
<span class="sd">;</span>
<span class="sd">Delete from temp1</span>
<span class="sd">where theord &lt;&gt; 1</span>
<span class="sd">;</span>
<span class="sd">Alter table temp1</span>
<span class="sd">drop column theord</span>
<span class="sd">;</span>
<span class="sd">Truncate games_played_reg_season</span>
<span class="sd">;</span>
<span class="sd">Insert into games_played_reg_season</span>
<span class="sd">Select * from temp1</span>
<span class="sd">;</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="p">)</span>

<span class="n">conn</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">&#39;postgresql+psycopg2://postgres:COLLECTORGOD@11@localhost:5432/tonyfirst&#39;</span><span class="p">)</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">raw_connection</span><span class="p">()</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
<span class="n">cur</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>


<h2>A Batch file runs the above cells except the Get All Games cell which only  needed to be run once</h2>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s1">&#39;postgresql+psycopg2://postgres:COLLECTORGOD@11@localhost:5432/tonyfirst&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;Select * from winning&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">DF</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">DF</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>

<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;team&#39;</span> <span class="p">,</span> <span class="s1">&#39;away_wins&#39;</span> <span class="p">,</span> <span class="s1">&#39;home_wins&#39;</span> <span class="p">,</span> <span class="s1">&#39;away_dif&#39;</span><span class="p">,</span> <span class="s1">&#39;home_dif&#39;</span> <span class="p">,</span> <span class="s1">&#39;total_wins&#39;</span> <span class="p">,</span> <span class="s1">&#39;total_dif&#39;</span><span class="p">]</span>
<span class="n">DF</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">cols</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;C:/Users/Tonyryanworldwide/Blog/content/pages/&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>  
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">ggplot</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">tnp</span> <span class="o">=</span> <span class="n">DF</span><span class="p">[</span><span class="s1">&#39;total_dif&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">tw</span> <span class="o">=</span> <span class="n">DF</span><span class="p">[</span><span class="s1">&#39;total_wins&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">linear_regressor</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span> 
<span class="n">linear_regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">tnp</span><span class="p">,</span> <span class="n">tw</span><span class="p">)</span> 
<span class="n">Y_pred</span> <span class="o">=</span> <span class="n">linear_regressor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">tnp</span><span class="p">)</span> 

<span class="n">p</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">tnp</span><span class="p">,</span><span class="n">tw</span><span class="p">,</span><span class="n">Y_pred</span><span class="p">)))</span>
<span class="n">p</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Net Points&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Wins&#39;</span> <span class="p">,</span> <span class="s1">&#39;Predicted Wins&#39;</span><span class="p">]</span>
<span class="n">minwins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;Total Wins&#39;</span><span class="p">]))</span>
<span class="n">maxwins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;Total Wins&#39;</span><span class="p">]))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">aes</span> <span class="p">(</span> <span class="s1">&#39;Net Points&#39;</span><span class="p">,</span> <span class="s1">&#39;Predicted Wins&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="n">geom_line</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">geom_point</span><span class="p">(</span>
    <span class="n">aes</span><span class="p">(</span><span class="s1">&#39;Net Points&#39;</span> <span class="p">,</span> <span class="s1">&#39;Total Wins&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">breaks</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">minwins</span><span class="p">,</span><span class="n">maxwins</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">x</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;wins_vs_points.png&#39;</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="https://Tonyryanworldwide.github.io/Blog/output_18_0.png"></p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://Tonyryanworldwide.github.io/Blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://www.linkedin.com/in/anthonyryandataanalyst/">LinkedIN</a></li>
                            <li><a href="https://www.upwork.com/freelancers/~0127c9e8445035f2d4">Upwork</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>